<<<<<<< HEAD
import { h } from 'vue'
=======
>>>>>>> master
import { mountDefault } from '../helpers'

describe('Scoped Slots', () => {
  it('receives an option object to the selected-option-container slot', () => {
    const Select = mountDefault(
<<<<<<< HEAD
      { modelValue: 'one' },
=======
      { value: 'one' },
>>>>>>> master
      {
        slots: {
          'selected-option-container': (slotProps) =>
            h(
              'span',
              { slot: 'selected-option-container' },
              slotProps.option.label
            ),
        },
      }
    )

<<<<<<< HEAD
    expect(Select.get('.vs__selected-options').text()).toEqual('one')
=======
    expect(Select.findComponent({ ref: 'selectedOptions' }).text()).toEqual(
      'one'
    )
>>>>>>> master
  })

  describe('Slot: selected-option', () => {
    it('receives an option object to the selected-option slot', () => {
      const Select = mountDefault(
<<<<<<< HEAD
        { modelValue: 'one' },
=======
        { value: 'one' },
>>>>>>> master
        {
          slots: {
            'selected-option': (slotProps) =>
              h('span', { slot: 'selected-option' }, slotProps.label),
          },
        }
      )

<<<<<<< HEAD
      expect(Select.get('.vs__selected').text()).toEqual('one')
=======
      expect(Select.find('.vs__selected').text()).toEqual('one')
>>>>>>> master
    })

    it('opens the dropdown when clicking an option in selected-option slot', () => {
      const Select = mountDefault(
<<<<<<< HEAD
        { modelValue: 'one' },
        {
          slots: {
            'selected-option': (slotProps) =>
              h('span', { class: 'my-option' }, slotProps.label),
=======
        { value: 'one' },
        {
          scopedSlots: {
            'selected-option': `<span class="my-option" slot-scope="option">{{ option.label }}</span>`,
>>>>>>> master
          },
        }
      )

<<<<<<< HEAD
      Select.get('.my-option').trigger('mousedown')
      expect(Select.vm.open).toEqual(true)
    })
  })

  it('receives an option object to the option slot in the dropdown menu', async () => {
    const Select = mountDefault(
      { modelValue: 'one' },
      {
        slots: {
          option: (slotProps) => h('span', { slot: 'option' }, slotProps.label),
        },
      }
    )

    Select.vm.open = true
    await Select.vm.$nextTick()

    expect(Select.get('.vs__dropdown-menu').text()).toEqual('onetwothree')
=======
      Select.find('.my-option').trigger('mousedown')
      expect(Select.vm.open).toEqual(true)
    })
  })

  it('receives an option object to the option slot in the dropdown menu', async () => {
    const Select = mountDefault(
      { value: 'one' },
      {
        scopedSlots: {
          option: `<span slot="option" slot-scope="option">{{ option.label }}</span>`,
        },
      }
    )

    Select.vm.open = true
    await Select.vm.$nextTick()

    expect(Select.findComponent({ ref: 'dropdownMenu' }).text()).toEqual(
      'onetwothree'
    )
>>>>>>> master
  })

  it('noOptions slot receives the current search text', async () => {
    const noOptions = jest.fn()
    const Select = mountDefault(
      {},
      {
<<<<<<< HEAD
        slots: { 'no-options': noOptions },
=======
        scopedSlots: { 'no-options': noOptions },
>>>>>>> master
      }
    )

    Select.vm.search = 'something not there'
    Select.vm.open = true
    await Select.vm.$nextTick()

    expect(noOptions).toHaveBeenCalledWith({
      loading: false,
      search: 'something not there',
      searching: true,
    })
  })

  test('header slot props', async () => {
    const header = jest.fn()
    const Select = mountDefault(
      {},
      {
<<<<<<< HEAD
        slots: { header: header },
=======
        scopedSlots: { header: header },
>>>>>>> master
      }
    )
    await Select.vm.$nextTick()
    expect(Object.keys(header.mock.calls[0][0])).toEqual([
      'search',
      'loading',
      'searching',
      'filteredOptions',
      'deselect',
    ])
  })

  test('footer slot props', async () => {
    const footer = jest.fn()
    const Select = mountDefault(
      {},
      {
<<<<<<< HEAD
        slots: { footer: footer },
=======
        scopedSlots: { footer: footer },
>>>>>>> master
      }
    )
    await Select.vm.$nextTick()
    expect(Object.keys(footer.mock.calls[0][0])).toEqual([
      'search',
      'loading',
      'searching',
      'filteredOptions',
      'deselect',
    ])
  })

  test('list-header slot props', async () => {
    const header = jest.fn()
    const Select = mountDefault(
      {},
      {
<<<<<<< HEAD
        slots: { 'list-header': header },
=======
        scopedSlots: { 'list-header': header },
>>>>>>> master
      }
    )
    Select.vm.open = true
    await Select.vm.$nextTick()
    expect(Object.keys(header.mock.calls[0][0])).toEqual([
      'search',
      'loading',
      'searching',
      'filteredOptions',
    ])
  })

  test('list-footer slot props', async () => {
    const footer = jest.fn()
    const Select = mountDefault(
      {},
      {
<<<<<<< HEAD
        slots: { 'list-footer': footer },
=======
        scopedSlots: { 'list-footer': footer },
>>>>>>> master
      }
    )
    Select.vm.open = true
    await Select.vm.$nextTick()
    expect(Object.keys(footer.mock.calls[0][0])).toEqual([
      'search',
      'loading',
      'searching',
      'filteredOptions',
    ])
  })
})
